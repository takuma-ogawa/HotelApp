{"remainingRequest":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\src\\pages\\RollCallStatus.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\src\\pages\\RollCallStatus.vue","mtime":1607356260360},{"path":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.search\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// @ is an alias to /src\nimport Card from '@/components/Card/Card.vue';\nimport config from '@/config.js';\nimport ElIncrementSearch from '@/components/IncrementSearch.vue';\nimport arrayFunction from '@/js/array.js';\nimport url from '@/js/api_url.js';\nimport time from '@/js/status/time.js';\nexport default {\n  name: 'niukeSyukei',\n  components: {\n    Card: Card,\n    ElIncrementSearch: ElIncrementSearch\n  },\n  data: function data() {\n    return {\n      data: {\n        search: {\n          model: {\n            memberName: \"\",\n            ServiceDate: \"\",\n            IsLongDistance: \"\",\n            IsAlert: false,\n            NarrowDestination: \"all\",\n            selectedDrivers: []\n          },\n          validation: {\n            memberName: [{\n              required: true,\n              message: '社員名が入力されていません',\n              trigger: 'blur'\n            }]\n          }\n        },\n        AlertColor: {\n          0: \"\",\n          1: \"\",\n          2: \"\"\n        },\n        drivers: [],\n        destinations: [],\n        meisai: [],\n        isSave: false\n      }\n    };\n  },\n  methods: {\n    moveRollCallInput: function moveRollCallInput(meisai_data) {\n      if (window.confirm(\"変更が保存されませんがよろしいですか？\")) {\n        this.$store.commit('changeMoveRollCallLogInput', {\n          ServiceDate: meisai_data.ServiceLog.ServiceDate,\n          MemberID: meisai_data.ServiceLog.DriverID\n        });\n        this.$router.push('/uedaunyu/rollCallLogInput');\n      }\n    },\n    getAlertColor: function getAlertColor(meisai_data) {\n      var alertKind = meisai_data.AlertKind;\n\n      if (meisai_data.IsDelete) {\n        return \"background-color:#a9a9a9;\";\n      } else {\n        if (alertKind == 0 || alertKind == 1 || alertKind == 2) {\n          return \"background-color:\" + this.data.AlertColor[alertKind] + \";\";\n        } else {\n          return \"\";\n        }\n      }\n    },\n    getDriversIndex: function getDriversIndex(DriverID) {\n      for (var i = 0; i < this.data.drivers.length; i++) {\n        if (this.data.drivers[i].MemberID == DriverID) {\n          return i;\n        }\n      }\n    },\n    getDriver: function getDriver(DriverID) {\n      return this.data.drivers[this.getDriversIndex(DriverID)];\n    },\n    addServiceLogAllDrivers: function addServiceLogAllDrivers() {\n      for (var i = 0; i < this.data.drivers.length; i++) {\n        var driver = this.data.drivers[i];\n        console.log(driver);\n        this.addServiceLog(driver.IsLongDistance, driver.DestinationID, -1, driver.MemberID, this.data.search.model.ServiceDate, driver.MemberName, \"\", \"\", \"\");\n      }\n    },\n    addServiceLogBySelectedDrivers: function addServiceLogBySelectedDrivers() {\n      for (var i = 0; i < this.data.search.model.selectedDrivers.length; i++) {\n        var driverID = this.data.search.model.selectedDrivers[i];\n\n        for (var k = 0; k < this.data.drivers.length; k++) {\n          var driver = this.data.drivers[k];\n\n          if (driver.MemberID == driverID) {\n            this.addServiceLog(driver.IsLongDistance, driver.DestinationID, -1, driver.MemberID, this.data.search.model.ServiceDate, driver.MemberName, \"\", \"\", \"\");\n          }\n        }\n      }\n    },\n    addServiceLog: function addServiceLog(IsLongDistance, DestinationID, ServiceLogID, DriverID, ServiceDate, MemberName, BeforDrivingRollCallTime, LastRollCallTime, AfterDrivingRollCallTime) {\n      this.data.meisai.push(this.createServiceLog(IsLongDistance, DestinationID, ServiceLogID, DriverID, ServiceDate, MemberName, BeforDrivingRollCallTime, LastRollCallTime, AfterDrivingRollCallTime));\n      console.log(this.data.meisai);\n    },\n    createServiceLog: function createServiceLog(IsLongDistance, DestinationID, ServiceLogID, DriverID, ServiceDate, MemberName, BeforDrivingRollCallTime, LastRollCallTime, AfterDrivingRollCallTime) {\n      var Visibility = this.createVisibilityObject();\n      return {\n        IsLongDistance: IsLongDistance,\n        Visibility: Visibility,\n        IsDelete: false,\n        IsEdit: false,\n        AlertKind: null,\n        ServiceLog: {\n          DestinationID: DestinationID,\n          CompanyID: this.data.companyID,\n          EditorID: this.data.editorID,\n          ServiceLogID: ServiceLogID,\n          DriverID: DriverID,\n          ServiceDate: ServiceDate,\n          MemberName: MemberName,\n          BeforDrivingRollCallTime: BeforDrivingRollCallTime,\n          LastRollCallTime: LastRollCallTime,\n          AfterDrivingRollCallTime: AfterDrivingRollCallTime\n        }\n      };\n    },\n    createVisibilityObject: function createVisibilityObject() {\n      return {\n        IsLongDistance: true,\n        MemberName: true,\n        IsAlert: true,\n        IsDecidedDestination: true\n      };\n    },\n    changeVisibilityIsLongDistance: function changeVisibilityIsLongDistance() {\n      var isLongDistance = this.data.search.model.IsLongDistance;\n\n      for (var i = 0; i < this.data.meisai.length; i++) {\n        if (!this.data.meisai[i].IsDelete) {\n          var visibility = true;\n\n          if (isLongDistance != null) {\n            if (this.data.meisai[i].IsLongDistance != isLongDistance) {\n              visibility = false;\n            }\n          }\n\n          this.data.meisai[i].Visibility.IsLongDistance = visibility;\n        }\n      }\n    },\n    changeVisibilityIsAlert: function changeVisibilityIsAlert() {\n      var isAlert = this.data.search.model.IsAlert;\n\n      for (var i = 0; i < this.data.meisai.length; i++) {\n        if (!this.data.meisai[i].IsDelete) {\n          var visibility = true;\n\n          if (isAlert) {\n            if (this.data.meisai[i].AlertKind == null) {\n              visibility = false;\n            }\n          }\n\n          this.data.meisai[i].Visibility.IsAlert = visibility;\n        }\n      }\n    },\n    changeVisibilityMemberName: function changeVisibilityMemberName() {\n      var memberName = this.data.search.model.memberName;\n\n      for (var i = 0; i < this.data.meisai.length; i++) {\n        if (!this.data.meisai[i].IsDelete) {\n          var visibility = true;\n\n          if (memberName != \"\") {\n            if (this.data.meisai[i].ServiceLog.MemberName.indexOf(memberName) == -1) {\n              visibility = false;\n            }\n          }\n\n          this.data.meisai[i].Visibility.MemberName = visibility;\n        }\n      }\n    },\n    changeVisibilityDestination: function changeVisibilityDestination() {\n      var destination = this.data.search.model.NarrowDestination;\n\n      for (var i = 0; i < this.data.meisai.length; i++) {\n        if (!this.data.meisai[i].IsDelete) {\n          var visibility = true;\n\n          if (destination != \"all\") {\n            var destinationID = this.data.meisai[i].ServiceLog.DestinationID;\n\n            if (destination == \"unDecided\") {\n              if (destinationID != null) {\n                visibility = false;\n              }\n            } else if (destination == \"decided\") {\n              if (destinationID == null) {\n                visibility = false;\n              }\n            }\n          }\n\n          this.data.meisai[i].Visibility.IsDecidedDestination = visibility;\n        }\n      }\n    },\n    judgeDisplayServiceLog: function judgeDisplayServiceLog(visibility) {\n      var result = true;\n\n      for (var i in visibility) {\n        if (!visibility[i]) {\n          result = false;\n        }\n      }\n\n      return result;\n    },\n    serviceLogSearch: function serviceLogSearch() {\n      var _this = this;\n\n      axios.get(url.ApiUrl().GetRollCallStatus([{\n        key: \"CompanyID\",\n        value: this.data.companyID\n      }, {\n        key: \"ServiceDate\",\n        value: this.data.search.model.ServiceDate\n      }])).then(function (response) {\n        console.log(response.data);\n\n        _this.$set(_this.data, \"meisai\", response.data);\n\n        for (var i in _this.data.meisai) {\n          _this.$set(_this.data.meisai[i], \"Visibility\", _this.createVisibilityObject());\n\n          _this.$set(_this.data.meisai[i].ServiceLog, \"MemberName\", _this.getDriver(_this.data.meisai[i].ServiceLog.DriverID).MemberName);\n        }\n\n        console.log(_this.data.meisai);\n      }).catch(function (response) {});\n    },\n    save: function save() {\n      var _this2 = this;\n\n      this.data.isSave = true;\n      axios.put(url.ApiUrl().RollCallStatusSave(), this.data.meisai).then(function (response) {\n        console.log(response.data);\n\n        if (response.data) {\n          _this2.$message({\n            message: '登録に成功しました',\n            type: 'success'\n          });\n\n          _this2.serviceLogSearch();\n        } else {\n          _this2.$message({\n            message: '登録に失敗しました',\n            type: 'error'\n          });\n        }\n\n        _this2.data.isSave = false;\n      }).catch(function (response) {\n        _this2.$message({\n          message: '通信に失敗しました',\n          type: 'error'\n        });\n\n        _this2.data.isSave = false;\n      });\n    },\n    sendEmail: function sendEmail() {\n      var _this3 = this;\n\n      this.data.isSave = true;\n      axios.post(url.ApiUrl().RollCallStatusSendEmail(), this.data.meisai).then(function (response) {\n        console.log(response.data);\n\n        if (response.data) {\n          _this3.$message({\n            message: '登録及び違反者へのメール送信に成功しました',\n            type: 'success'\n          });\n\n          _this3.serviceLogSearch();\n        } else {\n          _this3.$message({\n            message: '登録及び違反者へのメール送信に失敗しました',\n            type: 'error'\n          });\n        }\n\n        _this3.data.isSave = false;\n      }).catch(function (response) {\n        _this3.$message({\n          message: '通信に失敗しました',\n          type: 'error'\n        });\n\n        _this3.data.isSave = false;\n      });\n    }\n  },\n  created: function created() {\n    var _this4 = this;\n\n    this.data.companyID = this.$store.state.login.companyID;\n    this.data.editorID = this.$store.state.login.userID;\n    this.data.search.model.ServiceDate = time.nowJapanDateInput();\n    axios.get(url.ApiUrl().GetRollCallStatusMasterData([{\n      key: \"CompanyID\",\n      value: this.data.companyID\n    }])).then(function (response) {\n      console.log(response.data.Drivers);\n\n      _this4.$set(_this4.data, \"drivers\", response.data.Drivers);\n\n      _this4.$set(_this4.data, \"destinations\", response.data.Destinations);\n\n      _this4.$set(_this4.data, \"AlertColor\", response.data.AlertColor);\n\n      _this4.serviceLogSearch();\n    }).catch(function (response) {\n      return console.log(response);\n    });\n  },\n  mounted: function mounted() {},\n  watch: {}\n};",{"version":3,"sources":["RollCallStatus.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div>\r\n        <el-card>\r\n            <div slot='header'>\r\n                <span>点呼状況</span>\r\n            </div>\r\n            <div slot='default'>\r\n                <el-form :model=\"data.search.model\" :rules=\"data.search.validation\" ref=\"searchForm\" label-width=\"120px\">\r\n                    <div class=\"row\">\r\n                        <div class='col-md-3'>\r\n                            <label for='運行日' class='col-form-label px-1' style='width:100%;'>運行日</label>\r\n                            <el-form-item label-width=\"0\" prop=\"ServiceDate\">\r\n                                <el-input type=\"date\"\r\n                                          style='width:100%;'\r\n                                          v-model=\"data.search.model.ServiceDate\"\r\n                                          @change=\"serviceLogSearch()\"\r\n                                          ></el-input>\r\n\r\n                            </el-form-item>\r\n                        </div>\r\n                        <div class=\"col-3\">\r\n                            <label for='運行形態選択' class='col-form-label px-1' style='width:100%;'>運行形態選択</label>\r\n                            <el-form-item label-width=\"0\" prop=\"IsLongDistance\">\r\n                                <el-select name=\"name\" v-model=\"data.search.model.IsLongDistance\" placeholder=\"選択してください\" @change=\"changeVisibilityIsLongDistance()\">\r\n                                    <el-option :value=\"null\" label=\"選択しない\"></el-option>\r\n                                    <el-option :value=\"true\" label=\"長距離\"></el-option>\r\n                                    <el-option :value=\"false\" label=\"地場\"></el-option>\r\n                                </el-select>\r\n                            </el-form-item>\r\n                        </div>\r\n                        <div class=\"col-3\">\r\n                            <el-button style='margin-top:13%;width:80%;' type='primary' @click=\"sendEmail()\">更新</el-button>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"row\" style=\"margin-top:2%;\">\r\n                        <div class='col-md-3'>\r\n                            <label for='アラートのみ' class='col-form-label px-1' style='width:100%;'></label>\r\n                            <el-checkbox style=\"margin-left:5%;\" v-model=\"data.search.model.IsAlert\" @change=\"changeVisibilityIsAlert()\">アラートのみ</el-checkbox>\r\n                        </div>\r\n                        <div class='col-md-3'>\r\n                            <label for='社員検索' class='col-form-label px-1' style='width:100%;'>社員名検索</label>\r\n                            <el-form-item label-width=\"0\" prop=\"syoriKubun\">\r\n                                <el-input type='text'\r\n                                          style='width:100%;'\r\n                                          v-model=\"data.search.model.memberName\"\r\n                                          @change=\"changeVisibilityMemberName()\"\r\n                                          ></el-input>\r\n\r\n                            </el-form-item>\r\n                        </div>\r\n                        <div class='col-md-2'>\r\n                            <label for='社員検索' class='col-form-label px-1' style='width:100%;'>運行追加</label>\r\n                            <el-button type='warning' @click=\"addServiceLogAllDrivers()\">全社員分追加</el-button>\r\n                        </div>\r\n                        <div class='col-md-3'>\r\n                            <label for='社員検索' class='col-form-label px-1' style='width:100%;'>社員を指定して追加</label>\r\n                            <el-select name=\"name\" v-model=\"data.search.model.selectedDrivers\" style=\"margin-right:2%\" multiple>\r\n                                <el-option v-for=\"driver in data.drivers\" :value=\"driver.MemberID\" :label=\"driver.MemberName\"></el-option>\r\n                            </el-select>\r\n                            <el-button type='warning' @click=\"addServiceLogBySelectedDrivers()\">運行を追加</el-button>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"row\" style=\"margin-top:2%;\">\r\n                        <div class='col-md-3'>\r\n                            <el-radio style=\"margin-left:5%;\" v-model=\"data.search.model.NarrowDestination\" label=\"decided\" @change=\"changeVisibilityDestination()\">行先決定済みのみ</el-radio>\r\n                        </div>\r\n                        <div class='col-md-3'>\r\n                            <el-radio style=\"margin-left:5%;\" v-model=\"data.search.model.NarrowDestination\" label=\"unDecided\" @change=\"changeVisibilityDestination()\">行先未決定のみ</el-radio>\r\n                        </div>\r\n                        <div class='col-md-3'>\r\n                            <el-radio style=\"margin-left:5%;\" v-model=\"data.search.model.NarrowDestination\" label=\"all\" @change=\"changeVisibilityDestination()\">すべて</el-radio>\r\n                        </div>\r\n\r\n                    </div>\r\n                    <div class=\"row\" style=\"margin-top:2%;\">\r\n                        <div class='col-md-9'>\r\n                        </div>\r\n                        <div class='col-md-3'>\r\n                            <el-button style='margin-top:13%;width:80%;' type='danger'@click=\"save()\">変更を保存</el-button>\r\n                        </div>\r\n                   \r\n                    </div>\r\n\r\n                </el-form>\r\n                <div class=\"row\" style=\"margin-top:4%;\">\r\n                    <div class=\"col-12\">\r\n                        <table class=\"table\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>\r\n                                        社員名\r\n                                    </th>\r\n                                    <th>\r\n                                        行先\r\n                                    </th>\r\n                                    <th>\r\n                                        乗務前点呼時間\r\n                                    </th>\r\n                                    <th>\r\n                                        最終電話点呼時間\r\n                                    </th>\r\n                                    <th>\r\n                                        乗務後点呼時間\r\n                                    </th>\r\n                                    <th>\r\n                                        点呼内容を表示\r\n                                    </th>\r\n                                    <th>\r\n                                        運行を削除\r\n                                    </th>\r\n\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody v-for=\"meisai_data in data.meisai\" v-bind:key=\"meisai_data.index\" style=\"border-bottom:solid 0.5px #d3d3d3;\" v-if=\"judgeDisplayServiceLog(meisai_data.Visibility)\">\r\n                                <tr v-bind:style=\"getAlertColor(meisai_data)\">\r\n                                    <td>\r\n                                        {{meisai_data.ServiceLog.MemberName}}\r\n                                    </td>\r\n                                    <td style=\"width:20%;\">\r\n                                        <el-select name=\"name\" v-model=\"meisai_data.ServiceLog.DestinationID\" style=\"width:100%;\" @change=\"meisai_data.IsEdit = true\" :disabled=\"meisai_data.IsDelete\">\r\n                                            <el-option v-for=\"destination in data.destinations\" :value=\"destination.DestinationID\" :label=\"destination.DestinationName\"></el-option>\r\n                                        </el-select>\r\n                                    </td>\r\n                                    <td>\r\n                                        {{meisai_data.ServiceLog.BeforDrivingRollCallTime}}\r\n                                    </td>\r\n                                    <td>\r\n                                        {{meisai_data.ServiceLog.LastRollCallTime}}\r\n                                    </td>\r\n                                    <td>\r\n                                        {{meisai_data.ServiceLog.AfterDrivingRollCallTime}}\r\n                                    </td>\r\n                                    <td style=\"width:10%;\">\r\n                                        <el-button type='success' @click=\"moveRollCallInput(meisai_data)\" style=\"width:100%;\" :disabled=\"meisai_data.ServiceLog.ServiceLogID == -1\">点呼内容表示</el-button>\r\n                                    </td>\r\n                                    <td style=\"width:10%;\">\r\n                                        <el-button type='primary' @click=\"$set(meisai_data,'IsDelete',!meisai_data.IsDelete)\" style=\"width:100%;\">{{meisai_data.IsDelete ?\"復帰\" : \"削除\"}}</el-button>\r\n                                    </td>\r\n\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n\r\n\r\n\r\n            </div>\r\n        </el-card>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    // @ is an alias to /src\r\n    import Card from '@/components/Card/Card.vue'\r\n    import config from '@/config.js'\r\n    import ElIncrementSearch from '@/components/IncrementSearch.vue'\r\n    import arrayFunction from '@/js/array.js'\r\n    import url from '@/js/api_url.js'\r\n    import time from '@/js/status/time.js'\r\n\r\n\r\n    export default {\r\n        name: 'niukeSyukei',\r\n        components: {\r\n            Card, ElIncrementSearch\r\n        },\r\n        data: function () {\r\n            return {\r\n                data: {\r\n                    search: {\r\n                        model: {\r\n                            memberName: \"\",\r\n                            ServiceDate: \"\",\r\n                            IsLongDistance: \"\",\r\n                            IsAlert: false,\r\n                            NarrowDestination: \"all\",\r\n                            selectedDrivers: [],\r\n                        },\r\n                        validation: {\r\n                            memberName: [\r\n                                { required: true, message: '社員名が入力されていません', trigger: 'blur' },\r\n                            ],\r\n                        }\r\n                    },\r\n                    AlertColor: {\r\n                        0: \"\",\r\n                        1: \"\",\r\n                        2: \"\",\r\n                    },\r\n                    drivers: [],\r\n                    destinations: [],\r\n                    meisai: [],\r\n                    isSave: false,\r\n                },\r\n            }\r\n        },\r\n        methods: {\r\n\r\n            moveRollCallInput: function (meisai_data) {\r\n\r\n                if (window.confirm(\"変更が保存されませんがよろしいですか？\")) {\r\n\r\n                    this.$store.commit('changeMoveRollCallLogInput', { ServiceDate: meisai_data.ServiceLog.ServiceDate, MemberID: meisai_data.ServiceLog.DriverID });\r\n\r\n                    this.$router.push('/uedaunyu/rollCallLogInput');\r\n\r\n                }\r\n            },\r\n            getAlertColor: function (meisai_data) {\r\n\r\n                var alertKind = meisai_data.AlertKind;\r\n\r\n                if (meisai_data.IsDelete) {\r\n\r\n                    return \"background-color:#a9a9a9;\"\r\n\r\n                } else {\r\n                    if (alertKind == 0 || alertKind == 1 || alertKind == 2) {\r\n\r\n                        return \"background-color:\" + this.data.AlertColor[alertKind] + \";\";\r\n\r\n                    } else {\r\n\r\n                        return \"\";\r\n                    }\r\n                }\r\n\r\n               \r\n\r\n            },\r\n            getDriversIndex: function (DriverID) {\r\n\r\n                for (var i = 0; i < this.data.drivers.length; i++) {\r\n\r\n                    if (this.data.drivers[i].MemberID == DriverID) {\r\n                        return i;\r\n                    }\r\n                }\r\n\r\n\r\n            },\r\n            getDriver: function (DriverID) {\r\n\r\n                return this.data.drivers[this.getDriversIndex(DriverID)];\r\n            },\r\n            addServiceLogAllDrivers: function () {\r\n\r\n                for (var i = 0; i < this.data.drivers.length; i++) {\r\n\r\n                    var driver = this.data.drivers[i];\r\n\r\n                    console.log(driver);\r\n\r\n                    this.addServiceLog(driver.IsLongDistance, driver.DestinationID, -1, driver.MemberID,this.data.search.model.ServiceDate, driver.MemberName, \"\", \"\", \"\");\r\n\r\n                }\r\n\r\n            },\r\n            addServiceLogBySelectedDrivers: function () {\r\n\r\n                for (var i = 0; i < this.data.search.model.selectedDrivers.length; i++) {\r\n\r\n                    var driverID = this.data.search.model.selectedDrivers[i];\r\n\r\n                    for (var k = 0; k < this.data.drivers.length; k++) {\r\n\r\n                        var driver = this.data.drivers[k];\r\n\r\n                        if (driver.MemberID == driverID) {\r\n\r\n                            this.addServiceLog(driver.IsLongDistance, driver.DestinationID, -1, driver.MemberID, this.data.search.model.ServiceDate, driver.MemberName, \"\", \"\", \"\");\r\n                        }\r\n                        \r\n                    }\r\n\r\n                }\r\n\r\n\r\n            },\r\n            addServiceLog: function (IsLongDistance, DestinationID, ServiceLogID, DriverID, ServiceDate, MemberName, BeforDrivingRollCallTime, LastRollCallTime, AfterDrivingRollCallTime) {\r\n\r\n                this.data.meisai.push(this.createServiceLog(IsLongDistance, DestinationID, ServiceLogID, DriverID, ServiceDate, MemberName, BeforDrivingRollCallTime, LastRollCallTime, AfterDrivingRollCallTime));\r\n\r\n                console.log(this.data.meisai);\r\n                \r\n            },\r\n            createServiceLog: function (IsLongDistance, DestinationID, ServiceLogID, DriverID, ServiceDate, MemberName, BeforDrivingRollCallTime, LastRollCallTime, AfterDrivingRollCallTime) {\r\n\r\n\r\n                var Visibility = this.createVisibilityObject();\r\n\r\n                return {\r\n                    IsLongDistance: IsLongDistance,\r\n                    Visibility: Visibility,\r\n                    IsDelete: false,\r\n                    IsEdit: false,\r\n                    AlertKind: null,\r\n                    ServiceLog: {\r\n                        DestinationID: DestinationID,\r\n                        CompanyID: this.data.companyID,\r\n                        EditorID: this.data.editorID,\r\n                        ServiceLogID: ServiceLogID,\r\n                        DriverID: DriverID,\r\n                        ServiceDate: ServiceDate,\r\n                        MemberName: MemberName,\r\n                        BeforDrivingRollCallTime: BeforDrivingRollCallTime,\r\n                        LastRollCallTime: LastRollCallTime,\r\n                        AfterDrivingRollCallTime: AfterDrivingRollCallTime,\r\n\r\n                    }\r\n                }\r\n            },\r\n            createVisibilityObject: function () {\r\n\r\n                return {\r\n                    IsLongDistance: true,\r\n                    MemberName: true,\r\n                    IsAlert: true,\r\n                    IsDecidedDestination: true,\r\n                }\r\n            },\r\n            changeVisibilityIsLongDistance: function () {\r\n\r\n                var isLongDistance = this.data.search.model.IsLongDistance;\r\n                for (var i = 0; i < this.data.meisai.length; i++) {\r\n\r\n                    if (!this.data.meisai[i].IsDelete) {\r\n\r\n                        var visibility = true;\r\n\r\n                        if (isLongDistance != null) {\r\n\r\n                            if (this.data.meisai[i].IsLongDistance != isLongDistance) {\r\n                                visibility = false;\r\n                            }\r\n                        }\r\n\r\n                        this.data.meisai[i].Visibility.IsLongDistance = visibility;\r\n                    }\r\n\r\n                }\r\n\r\n            },\r\n            changeVisibilityIsAlert: function () {\r\n\r\n                var isAlert = this.data.search.model.IsAlert;\r\n\r\n                for (var i = 0; i < this.data.meisai.length; i++) {\r\n                    if (!this.data.meisai[i].IsDelete) {\r\n\r\n                        var visibility = true;\r\n\r\n                        if (isAlert) {\r\n\r\n                            if (this.data.meisai[i].AlertKind == null) {\r\n                                visibility = false;\r\n\r\n                            }\r\n                        }\r\n\r\n                        this.data.meisai[i].Visibility.IsAlert = visibility;\r\n                    }\r\n                }\r\n\r\n            },\r\n            changeVisibilityMemberName: function () {\r\n\r\n                var memberName = this.data.search.model.memberName;\r\n\r\n                for (var i = 0; i < this.data.meisai.length; i++) {\r\n                    if (!this.data.meisai[i].IsDelete) {\r\n\r\n                        var visibility = true;\r\n\r\n                        if (memberName != \"\") {\r\n\r\n                            if (this.data.meisai[i].ServiceLog.MemberName.indexOf(memberName) == -1) {\r\n\r\n                                visibility = false;\r\n\r\n                            }\r\n                        }\r\n\r\n                        this.data.meisai[i].Visibility.MemberName = visibility;\r\n                    }\r\n                }\r\n\r\n            },\r\n            changeVisibilityDestination: function () {\r\n\r\n                var destination = this.data.search.model.NarrowDestination;\r\n\r\n                for (var i = 0; i < this.data.meisai.length; i++) {\r\n                    if (!this.data.meisai[i].IsDelete) {\r\n\r\n                        var visibility = true;\r\n\r\n                        if (destination != \"all\") {\r\n\r\n                            var destinationID = this.data.meisai[i].ServiceLog.DestinationID;\r\n\r\n                            if (destination == \"unDecided\") {\r\n                                if (destinationID != null) {\r\n                                    visibility = false;\r\n                                }\r\n                            } else if (destination == \"decided\") {\r\n                                if (destinationID == null) {\r\n                                    visibility = false;\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        this.data.meisai[i].Visibility.IsDecidedDestination = visibility;\r\n                    }\r\n                }\r\n\r\n            },\r\n\r\n\r\n            judgeDisplayServiceLog: function (visibility) {\r\n\r\n                var result = true;\r\n\r\n                for (var i in visibility) {\r\n\r\n                    if (!visibility[i]) {\r\n                        result = false;\r\n                    }\r\n\r\n                }\r\n                return result\r\n            },\r\n            serviceLogSearch: function () {\r\n\r\n                axios.get(url.ApiUrl().GetRollCallStatus([{ key: \"CompanyID\", value: this.data.companyID }, { key: \"ServiceDate\", value: this.data.search.model.ServiceDate }]))\r\n                    .then(response => {\r\n\r\n                        console.log(response.data);\r\n                        this.$set(this.data, \"meisai\", response.data);\r\n\r\n                        for (var i in this.data.meisai) {\r\n\r\n                            this.$set(this.data.meisai[i], \"Visibility\", this.createVisibilityObject());\r\n\r\n                            this.$set(this.data.meisai[i].ServiceLog, \"MemberName\", this.getDriver(this.data.meisai[i].ServiceLog.DriverID).MemberName);\r\n\r\n                        }\r\n\r\n                        console.log(this.data.meisai);\r\n\r\n              \r\n                    })\r\n                    .catch(response => {\r\n                    })\r\n\r\n\r\n            },\r\n            save: function () {\r\n\r\n                this.data.isSave = true;\r\n                axios.put(url.ApiUrl().RollCallStatusSave(), this.data.meisai)\r\n                    .then(response => {\r\n\r\n                        console.log(response.data);\r\n                        if (response.data) {\r\n\r\n                            this.$message({\r\n                                message: '登録に成功しました',\r\n                                type: 'success'\r\n                            });\r\n\r\n                            this.serviceLogSearch();\r\n\r\n                        } else {\r\n\r\n                            this.$message({\r\n                                message: '登録に失敗しました',\r\n                                type: 'error'\r\n                            });\r\n\r\n                        }\r\n\r\n\r\n                        this.data.isSave = false;\r\n\r\n                    })\r\n                    .catch(response => {\r\n\r\n                        this.$message({\r\n                            message: '通信に失敗しました',\r\n                            type: 'error'\r\n                        });\r\n\r\n                        this.data.isSave = false;\r\n\r\n                    })\r\n\r\n            },\r\n            sendEmail: function () {\r\n\r\n                this.data.isSave = true;\r\n                axios.post(url.ApiUrl().RollCallStatusSendEmail(), this.data.meisai)\r\n                    .then(response => {\r\n\r\n                        console.log(response.data);\r\n                        if (response.data) {\r\n\r\n                            this.$message({\r\n                                message: '登録及び違反者へのメール送信に成功しました',\r\n                                type: 'success'\r\n                            });\r\n\r\n                            this.serviceLogSearch();\r\n\r\n                        } else {\r\n\r\n                            this.$message({\r\n                                message: '登録及び違反者へのメール送信に失敗しました',\r\n                                type: 'error'\r\n                            });\r\n\r\n                        }\r\n\r\n\r\n                        this.data.isSave = false;\r\n\r\n                    })\r\n                    .catch(response => {\r\n\r\n                        this.$message({\r\n                            message: '通信に失敗しました',\r\n                            type: 'error'\r\n                        });\r\n\r\n                        this.data.isSave = false;\r\n\r\n                    })\r\n\r\n            }\r\n\r\n\r\n        },\r\n        created: function () {\r\n\r\n\r\n            this.data.companyID = this.$store.state.login.companyID;\r\n            this.data.editorID = this.$store.state.login.userID;\r\n\r\n            this.data.search.model.ServiceDate = time.nowJapanDateInput();\r\n\r\n            axios.get(url.ApiUrl().GetRollCallStatusMasterData([{ key: \"CompanyID\", value: this.data.companyID }]))\r\n                .then(response => {\r\n\r\n                    console.log(response.data.Drivers);\r\n\r\n                    this.$set(this.data, \"drivers\", response.data.Drivers);\r\n                    this.$set(this.data, \"destinations\", response.data.Destinations);\r\n\r\n                    this.$set(this.data, \"AlertColor\", response.data.AlertColor);\r\n\r\n\r\n                    this.serviceLogSearch();\r\n\r\n                })\r\n                .catch(response => console.log(response))\r\n\r\n\r\n        },\r\n        mounted: function () {\r\n\r\n        },\r\n        watch: {\r\n\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n    .search {\r\n        background-color: blue;\r\n        color: white;\r\n    }\r\n</style>"],"sourceRoot":"src/pages"}]}