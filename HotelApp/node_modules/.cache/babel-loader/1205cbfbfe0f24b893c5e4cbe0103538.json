{"remainingRequest":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\src\\pages\\MasterVehicle.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\src\\pages\\MasterVehicle.vue","mtime":1604504627331},{"path":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\HotelApp\\project\\HotelApp\\HotelApp\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.search\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// @ is an alias to /src\nimport Card from '@/components/Card/Card.vue';\nimport arrayFunction from '@/js/array.js';\nimport url from '@/js/api_url.js';\nexport default {\n  name: 'niukeSyukei',\n  components: {\n    Card: Card\n  },\n  data: function data() {\n    return {\n      data: {\n        companyID: \"\",\n        //新規作成のIDは-1ととりあえず置いておく\n        //CRUDKeyは0が何もなし、1が編集,2が削除,3が新規\n        newID: -1,\n        search: {\n          model: {\n            memberName: \"\"\n          },\n          validation: {\n            Name: [{\n              required: true,\n              message: '車両名が入力されていません',\n              trigger: 'blur'\n            }]\n          }\n        },\n        master: {\n          model: {\n            meisai: []\n          }\n        },\n        disabled: {\n          save: false\n        }\n      }\n    };\n  },\n  methods: {\n    searchName: function searchName() {\n      var _this = this;\n\n      this.$refs['searchForm'].validate(function (valid) {\n        if (valid) {\n          axios.get(url.ApiUrl().VehicleSearch([{\n            key: \"CompanyID\",\n            value: _this.data.companyID\n          }, {\n            key: \"Name\",\n            value: _this.data.search.model.Name\n          }])).then(function (response) {\n            console.log(response.data);\n\n            _this.$set(_this.data.master.model, \"meisai\", response.data);\n          }).catch(function (response) {\n            return console.log(response);\n          });\n        }\n      });\n    },\n    masterCodeOverLap: function masterCodeOverLap(meisai, index) {\n      var _this2 = this;\n\n      axios.get(url.ApiUrl().IsVehicleCodeOverLap([{\n        key: \"CompanyID\",\n        value: this.data.companyID\n      }, {\n        key: \"VehicleID\",\n        value: meisai.Vehicle.VehicleID\n      }, {\n        key: \"VehicleCode\",\n        value: meisai.Vehicle.VehicleCode\n      }])).then(function (response) {\n        if (!response.data) {\n          for (var i = 0; i < _this2.data.master.model.meisai.length; i++) {\n            if (_this2.data.master.model.meisai[i].Vehicle.VehicleCode == meisai.Vehicle.VehicleCode) {\n              if (index != i && _this2.data.master.model.meisai[i].Crud != 2) {\n                alert(\"入力されたコードは既に存在します\");\n                meisai.Vehicle.VehicleCode = \"\";\n              }\n            }\n          }\n        } else {\n          alert(\"入力されたコードは既に存在します\");\n          meisai.Vehicle.VehicleCode = \"\";\n        }\n      }).catch(function (response) {\n        return console.log(response);\n      });\n      this.changeCrud(meisai, 1);\n    },\n    getVehicles: function getVehicles() {\n      var _this3 = this;\n\n      axios.get(url.ApiUrl().GetVehiclesMaster([{\n        key: \"CompanyID\",\n        value: this.data.companyID\n      }])).then(function (response) {\n        _this3.$set(_this3.data.master.model, \"meisai\", response.data);\n      }).catch(function (response) {\n        return console.log(response);\n      });\n    },\n    createMeisaiData: function createMeisaiData(VehicleID, VehicleCode, VehicleName, Crud) {\n      return {\n        Vehicle: {\n          VehicleID: VehicleID,\n          VehicleCode: VehicleCode,\n          VehicleName: VehicleName,\n          CompanyID: this.data.companyID,\n          EditorID: this.data.editorID\n        },\n        Crud: Crud\n      };\n    },\n    addMeisai: function addMeisai(VehicleID, VehicleCode, VehicleName, Crud) {\n      var meisai = this.createMeisaiData(VehicleID, VehicleCode, VehicleName, Crud);\n      this.data.master.model.meisai.push(meisai);\n      console.log(this.data.master.model.meisai);\n    },\n    removeMeisai: function removeMeisai(meisai, index) {\n      if (meisai.Crud == 3) {\n        this.data.master.model.meisai.splice(index, 1);\n      } else {\n        this.$set(meisai, 'Crud', 2);\n      }\n    },\n    changeCrud: function changeCrud(meisai, value) {\n      if (meisai.Crud != 3) {\n        this.$set(meisai, 'Crud', value);\n      }\n    },\n    changeEditorID: function changeEditorID(meisai) {\n      for (var i in meisai) {\n        if (meisai[i].Crud != 0) {\n          meisai[i].Vehicle.EditorID = this.data.editorID;\n        }\n      }\n    },\n    submit: function submit() {\n      var _this4 = this;\n\n      this.$refs['masterForm'].validate(function (valid) {\n        if (valid) {\n          _this4.changeEditorID(_this4.data.master.model.meisai); //※axiosによる更新処理\n\n\n          _this4.data.disabled.save = true;\n          axios.post(url.ApiUrl().VehiclesMasterSave(), _this4.data.master.model.meisai).then(function (response) {\n            if (response.data) {\n              _this4.$message({\n                message: '登録に成功しました',\n                type: 'success'\n              });\n\n              _this4.getVehicles();\n            } else {\n              _this4.$message({\n                message: '登録に失敗しました',\n                type: 'error'\n              });\n            }\n\n            _this4.data.disabled.save = false;\n          }).catch(function (response) {\n            _this4.$message({\n              message: '通信に失敗しました',\n              type: 'error'\n            });\n\n            _this4.data.disabled.save = false;\n          });\n        }\n      });\n    }\n  },\n  created: function created() {\n    this.data.companyID = this.$store.state.login.companyID;\n    this.data.editorID = this.$store.state.login.userID;\n    this.getVehicles();\n  },\n  mounted: function mounted() {},\n  watch: {}\n};",{"version":3,"sources":["MasterVehicle.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div>\r\n        <el-card>\r\n            <div slot='header'>\r\n                <span>車両マスタ</span>\r\n            </div>\r\n            <div slot='default'>\r\n                <el-form :model=\"data.search.model\" :rules=\"data.search.validation\" ref=\"searchForm\" label-width=\"120px\">\r\n                    <div class=\"row\">\r\n                        <div class='col-3'>\r\n                            <label for='車両検索' class='col-form-label px-1' style='width:100%;'>車両名</label>\r\n                            <el-form-item label-width=\"0\" prop=\"syoriKubun\">\r\n                                <el-input type='text'\r\n                                          style='width:100%;'\r\n                                          v-model=\"data.search.model.Name\"></el-input>\r\n\r\n                            </el-form-item>\r\n                        </div>\r\n                        <div class=\"col-3\">\r\n                            <label for='' class='col-form-label px-1' style='width:100%;'>検索</label>\r\n                            <el-button style='margin-left:2%;' type='warning' icon=\"el-icon-search\" @click=\"searchName\">検索</el-button>\r\n                        </div>\r\n                    </div>\r\n                </el-form>\r\n                <div class=\"row\" style=\"margin-top:4%;\">\r\n                    <div class=\"col-12\">\r\n                        <div style=\"text-align:right;\">\r\n                            <el-button style='margin-left:2%;width:10%;' type='danger' :disabled=\"data.disabled.save\" @click=\"submit\">保存</el-button>\r\n                        </div>\r\n                        <el-form :model=\"data.master.model\" :rules=\"data.master.validation\" ref=\"masterForm\" label-width=\"120px\">\r\n                            <div style=\"text-align:center;\">\r\n                                <el-button type='primary'\r\n                                           style='width:40%;display:inline;'\r\n                                           @click=\"addMeisai(data.newID,'','',3)\"\r\n                                           :disabled=\"data.disabled.save\">明細を追加</el-button>\r\n                            </div>\r\n                            <table class=\"table\">\r\n                                <thead>\r\n                                    <tr>\r\n                                        <th>\r\n\r\n                                        </th>\r\n                                        <th>\r\n                                            車両コード\r\n                                        </th>\r\n                                        <th>\r\n                                            車両名\r\n                                        </th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tr v-for=\"(meisai_data,index) in data.master.model.meisai\" v-if=\"meisai_data.Crud != 2\">\r\n                                    <td>\r\n                                        <el-button type=\"primary\" name=\"name\" v-on:click=\"removeMeisai(meisai_data,index)\" :disabled=\"data.disabled.save\">削除</el-button>\r\n                                    </td>\r\n                                    <td>\r\n                                        <el-form-item label-width=\"0\"\r\n                                                      :prop=\"'meisai[' + index + '].Vehicle.VehicleCode'\"\r\n                                                      :rules=\"{\r\n                                                              required: true, message: '車両コードが入力されていません', trigger: 'blur'\r\n                                                              }\">\r\n                                            <el-input type='text'\r\n                                                      style='width:100%;'\r\n                                                      v-model=\"meisai_data.Vehicle.VehicleCode\"\r\n                                                      @change=\"masterCodeOverLap(meisai_data,index)\"\r\n                                                      :disabled=\"data.disabled.save\"></el-input>\r\n                                        </el-form-item>\r\n                                    </td>\r\n                                    <td>\r\n                                        <el-form-item label-width=\"0\"\r\n                                                      :prop=\"'meisai[' + index + '].Vehicle.VehicleName'\"\r\n                                                      :rules=\"{\r\n                                                              required: true, message: '車両名が入力されていません', trigger: 'blur'\r\n                                                              }\">\r\n                                            <el-input type='text'\r\n                                                      style='width:100%;'\r\n                                                      v-model=\"meisai_data.Vehicle.VehicleName\"\r\n                                                      @change=\"changeCrud(meisai_data, 1)\"\r\n                                                      :disabled=\"data.disabled.save\"></el-input>\r\n                                        </el-form-item>\r\n                                    </td>\r\n                                </tr>\r\n                            </table>\r\n                            <div style=\"text-align:center;\">\r\n                                <el-button type='primary'\r\n                                           style='width:40%;display:inline;'\r\n                                           @click=\"addMeisai(data.newID,'','',3)\"\r\n                                           :disabled=\"data.disabled.save\">明細を追加</el-button>\r\n                            </div>\r\n                        </el-form>\r\n                        <div style=\"text-align:right;\">\r\n                            <el-button style='margin-left:2%;width:10%;' type='danger' :disabled=\"data.disabled.save\" @click=\"submit\">保存</el-button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n\r\n\r\n            </div>\r\n        </el-card>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    // @ is an alias to /src\r\n    import Card from '@/components/Card/Card.vue'\r\n    import arrayFunction from '@/js/array.js'\r\n    import url from '@/js/api_url.js'\r\n\r\n    export default {\r\n        name: 'niukeSyukei',\r\n        components: {\r\n            Card\r\n        },\r\n        data: function () {\r\n            return {\r\n                data: {\r\n                    companyID: \"\",\r\n                    //新規作成のIDは-1ととりあえず置いておく\r\n                    //CRUDKeyは0が何もなし、1が編集,2が削除,3が新規\r\n                    newID: -1,\r\n                    search: {\r\n                        model: {\r\n                            memberName: \"\"\r\n                        },\r\n                        validation: {\r\n                            Name: [\r\n                                { required: true, message: '車両名が入力されていません', trigger: 'blur' },\r\n                            ],\r\n                        }\r\n                    },\r\n                    master: {\r\n                        model: {\r\n                            meisai: [],\r\n                        },\r\n                    },\r\n                    disabled: {\r\n                        save: false,\r\n                    },\r\n                },\r\n            }\r\n        },\r\n        methods: {\r\n            searchName: function () {\r\n\r\n                this.$refs['searchForm'].validate((valid) => {\r\n\r\n                    if (valid) {\r\n\r\n                        axios.get(url.ApiUrl().VehicleSearch([{ key: \"CompanyID\", value: this.data.companyID }, { key: \"Name\", value: this.data.search.model.Name }]))\r\n                            .then(response => {\r\n\r\n                                console.log(response.data);\r\n\r\n                                this.$set(this.data.master.model, \"meisai\", response.data);\r\n\r\n                            })\r\n                            .catch(response => console.log(response))\r\n\r\n                    }\r\n                })\r\n\r\n\r\n            },\r\n            masterCodeOverLap: function (meisai, index) {\r\n\r\n                axios.get(url.ApiUrl().IsVehicleCodeOverLap([{ key: \"CompanyID\", value: this.data.companyID }, { key: \"VehicleID\", value: meisai.Vehicle.VehicleID }, { key: \"VehicleCode\", value: meisai.Vehicle.VehicleCode }]))\r\n                    .then(response => {\r\n                        if (!response.data) {\r\n\r\n                            for (var i = 0; i < this.data.master.model.meisai.length; i++) {\r\n\r\n                                if (this.data.master.model.meisai[i].Vehicle.VehicleCode == meisai.Vehicle.VehicleCode) {\r\n\r\n                                    if (index != i && this.data.master.model.meisai[i].Crud != 2) {\r\n\r\n                                        alert(\"入力されたコードは既に存在します\");\r\n\r\n                                        meisai.Vehicle.VehicleCode = \"\";\r\n\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                        } else {\r\n\r\n                            alert(\"入力されたコードは既に存在します\");\r\n\r\n                            meisai.Vehicle.VehicleCode = \"\";\r\n\r\n                        }\r\n\r\n\r\n                    })\r\n                    .catch(response => console.log(response))\r\n\r\n\r\n                this.changeCrud(meisai, 1);\r\n            },\r\n            getVehicles: function () {\r\n\r\n                axios.get(url.ApiUrl().GetVehiclesMaster([{ key: \"CompanyID\", value: this.data.companyID }]))\r\n                    .then(response => {\r\n\r\n\r\n                        this.$set(this.data.master.model, \"meisai\", response.data);\r\n\r\n                    })\r\n                    .catch(response => console.log(response))\r\n\r\n            },\r\n            createMeisaiData: function (VehicleID, VehicleCode, VehicleName, Crud) {\r\n\r\n                return {\r\n                    Vehicle: {\r\n                        VehicleID: VehicleID,\r\n                        VehicleCode: VehicleCode,\r\n                        VehicleName: VehicleName,\r\n                        CompanyID: this.data.companyID,\r\n                        EditorID: this.data.editorID,\r\n\r\n                    },\r\n                    Crud: Crud\r\n                }\r\n            },\r\n            addMeisai: function (VehicleID, VehicleCode, VehicleName, Crud) {\r\n\r\n                var meisai = this.createMeisaiData(VehicleID, VehicleCode, VehicleName, Crud);\r\n                this.data.master.model.meisai.push(meisai);\r\n\r\n                console.log(this.data.master.model.meisai);\r\n            },\r\n            removeMeisai: function (meisai, index) {\r\n\r\n                if (meisai.Crud == 3) {\r\n                    this.data.master.model.meisai.splice(index, 1);\r\n                } else {\r\n\r\n                    this.$set(meisai, 'Crud', 2)\r\n\r\n                }\r\n\r\n            },\r\n            changeCrud: function (meisai, value) {\r\n\r\n                if (meisai.Crud != 3) {\r\n\r\n                    this.$set(meisai, 'Crud', value)\r\n\r\n                }\r\n            },\r\n            changeEditorID: function (meisai) {\r\n\r\n                for (var i in meisai) {\r\n\r\n                    if (meisai[i].Crud != 0) {\r\n\r\n                        meisai[i].Vehicle.EditorID = this.data.editorID;\r\n                    }\r\n                }\r\n            },\r\n            submit: function () {\r\n\r\n                this.$refs['masterForm'].validate((valid) => {\r\n\r\n                    if (valid) {\r\n\r\n                        this.changeEditorID(this.data.master.model.meisai);\r\n\r\n                        //※axiosによる更新処理\r\n\r\n                        this.data.disabled.save = true;\r\n\r\n                        axios.post(url.ApiUrl().VehiclesMasterSave(), this.data.master.model.meisai)\r\n                            .then(response => {\r\n\r\n                                if (response.data) {\r\n\r\n                                    this.$message({\r\n                                        message: '登録に成功しました',\r\n                                        type: 'success'\r\n                                    });\r\n\r\n                                    this.getVehicles();\r\n                                } else {\r\n\r\n                                    this.$message({\r\n                                        message: '登録に失敗しました',\r\n                                        type: 'error'\r\n                                    });\r\n\r\n                                }\r\n\r\n\r\n                                this.data.disabled.save = false;\r\n\r\n                            })\r\n                            .catch(response => {\r\n                                this.$message({\r\n                                    message: '通信に失敗しました',\r\n                                    type: 'error'\r\n                                });\r\n\r\n                                this.data.disabled.save = false;\r\n\r\n                            });\r\n                    }\r\n                })\r\n\r\n            }\r\n        },\r\n        created: function () {\r\n            this.data.companyID = this.$store.state.login.companyID;\r\n            this.data.editorID = this.$store.state.login.userID;\r\n\r\n            this.getVehicles();\r\n\r\n        },\r\n        mounted: function () {\r\n\r\n\r\n        },\r\n        watch: {\r\n\r\n        }\r\n    }\r\n</script>\r\n"],"sourceRoot":"src/pages"}]}